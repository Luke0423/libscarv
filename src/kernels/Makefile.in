
KERNELS_LIB  = scarvkernels

KERNELS_PATHS= src/kernels \
            src/kernels/$(ARCH) \

KERNELS_SRCS = $(foreach DIR,${KERNELS_PATHS},$(wildcard ${DIR}/*.c)) \
              $(foreach DIR,${KERNELS_PATHS},$(wildcard ${DIR}/*.S)) \
              src/share/util.c

KERNELS_HEAD = $(foreach DIR,${KERNELS_PATHS},$(wildcard ${DIR}/*.h))

KERNELS_FLAGS= -I$(INSTALL_DIR)/include

# Create targets for the headers
$(foreach FILE,$(KERNELS_HEAD),$(eval $(call tgt_include_header,$(FILE),kernels)))
$(foreach FILE,$(KERNELS_SRCS),$(eval $(call tgt_obj,$(FILE),kernels,$(KERNELS_FLAGS))))
$(foreach FILE,$(KERNELS_SRCS),$(eval $(call tgt_disasm,$(FILE),kernels,$(KERNELS_FLAGS))))


KERNELS_HEADERS =$(foreach FILE, $(KERNELS_HEAD), $(call map_include,$(FILE),kernels))
KERNELS_OBJS    =$(foreach FILE, $(KERNELS_SRCS), $(call map_obj,$(FILE),kernels))
KERNELS_DISASM  =$(foreach FILE, $(KERNELS_SRCS), $(call map_disasm,$(FILE),kernels))

# Add to the list of headers/objects etc to create.
HEADERS += $(KERNELS_HEADERS)
OBJS    += $(KERNELS_OBJS)
DISASM  += $(KERNELS_DISASM)

# libscarvkernels to the list of static libraries to build
LIBS += $(call map_static_lib,$(KERNELS_LIB))
$(eval $(call tgt_static_lib,$(KERNELS_OBJS),$(KERNELS_LIB)))

