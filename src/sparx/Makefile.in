
SPARX_LIB  = scarvsparx

SPARX_PATHS= src/sparx \
             src/sparx/$(ARCH) \
             src/share/util.c

SPARX_SRCS = $(foreach DIR,${SPARX_PATHS},$(wildcard ${DIR}/*.c)) \
            $(foreach DIR,${SPARX_PATHS},$(wildcard ${DIR}/*.S)) \

SPARX_HEAD = $(foreach DIR,${SPARX_PATHS},$(wildcard ${DIR}/*.h))

SPARX_FLAGS= -I$(INSTALL_DIR)/include

# Create targets for the headers
$(foreach FILE,$(SPARX_HEAD),$(eval $(call tgt_include_header,$(FILE),sparx)))
$(foreach FILE,$(SPARX_SRCS),$(eval $(call tgt_obj,$(FILE),sparx,$(SPARX_FLAGS))))
$(foreach FILE,$(SPARX_SRCS),$(eval $(call tgt_disasm,$(FILE),sparx,$(SPARX_FLAGS))))


SPARX_HEADERS =$(foreach FILE, $(SPARX_HEAD), $(call map_include,$(FILE),sparx))
SPARX_OBJS    =$(foreach FILE, $(SPARX_SRCS), $(call map_obj,$(FILE),sparx))
SPARX_DISASM  =$(foreach FILE, $(SPARX_SRCS), $(call map_disasm,$(FILE),sparx))

# Add to the list of headers/objects etc to create.
HEADERS += $(SPARX_HEADERS)
OBJS    += $(SPARX_OBJS)
DISASM  += $(SPARX_DISASM)

# libscarvsparx to the list of static libraries to build
LIBS += $(call map_static_lib,$(SPARX_LIB))
$(eval $(call tgt_static_lib,$(SPARX_OBJS),$(SPARX_LIB)))

